

declare int fopen_s(void** stream, char* filename, char* mode);
declare int fclose(void* stream);

declare int fseek(void* stream, int offset, int origin);
declare ulong ftell(void* stream);
declare void rewind(void* stream);
declare ulong fread(void* buffer, ulong elementSize, ulong elementCount, void* stream);

declare void printf(char* format, char* arg1, uint arg2);
declare void* calloc(ulong count, ulong size);
declare void* malloc(ulong size);

let println(char* str) {
    printf("%s\n", str, 0u);
}

let printNum(uint num) {
    printf("%s%d", "", num);
}

char* fileread(char* filename) {
    void* stream;
    if (fopen_s(*stream, filename, "r")) {
        println("Could not open file");
        return null;
    }

    fseek(stream, 0, 2); // 2 = SEEK_END
    ulong len = ftell(stream);
    rewind(stream);
    
    char* res = calloc(len + 1, 1ul);
    fread(res, 1ul, len, stream);

    fclose(stream);

    return res;
}